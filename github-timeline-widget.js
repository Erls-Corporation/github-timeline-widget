var GitHubTimelineApi,__bind=function(e,a){return function(){return e.apply(a,arguments)}};
GitHubTimelineApi=function(){function e(){}e.prototype._strongify=function(a){return"<strong>"+a+"</strong>"};e.prototype.formatAsTimeAgo=function(a){var b;b=((new Date).getTime()-a.getTime())/1E3;a=Math.floor(b/86400);if(isNaN(a)||a<0)return null;if(a===0)if(b<60)return"just now";else if(b<120)return"1 minute ago";else if(b<3600)return""+Math.floor(b/60)+" minutes ago";else if(b<7200)return"1 hour ago";else{if(b<86400)return""+Math.floor(b/3600)+" hours ago"}else return a===1?"Yesterday":a<7?""+
a+" days ago":""+Math.ceil(a/7)+" weeks ago"};e.prototype._parseGitHubEvent=function(a){var b,d,c,f,e;e=(a.url!=null?a.url:void 0)||(((f=a.payload)!=null?f.url:void 0)!=null?a.payload.url:void 0)||"https://github.com";e=e.replace("github.com//","github.com/");f=(new Date((a.created_at!=null?a.created_at:void 0)||0)).valueOf();a.repository!=null&&(d=this._strongify(""+a.repository.owner+"/"+a.repository.name));switch(a.type){case "CreateEvent":b="https://github.com/images/modules/dashboard/news/create.png";
switch(a.payload.object){case "repository":c="created repo "+d;break;case "tag":c="created tag "+this._strongify(a.payload.object_name)+" at "+d;break;case "branch":c="created branch "+this._strongify(a.payload.object_name)+" at "+d}break;case "MemberEvent":switch(a.payload.action){case "added":b="https://github.com/images/modules/dashboard/news/member_add.png",c="added "+this._strongify(a.payload.member)+" to "+d}break;case "PushEvent":a=a.payload.ref.substr(a.payload.ref.lastIndexOf("/")+1);b="https://github.com/images/modules/dashboard/news/push.png";
c="pushed to "+this._strongify(a)+" at "+d;break;case "ForkApplyEvent":b="https://github.com/images/modules/dashboard/news/merge.png";c="merged to "+d;break;case "ForkEvent":b="https://github.com/images/modules/dashboard/news/fork.png";c="forked "+d;break;case "WatchEvent":switch(a.payload.action){case "started":b="https://github.com/images/modules/dashboard/news/watch_started.png";c="started watching "+d;break;case "stopped":b="https://github.com/images/modules/dashboard/news/watch_stopped.png",
c="stopped watching "+d}break;case "FollowEvent":c=null;break;case "IssuesEvent":case "PullRequestEvent":switch(a.payload.action){case "opened":case "reopened":b="https://github.com/images/modules/dashboard/news/issues_opened.png";c="opened issued on "+d;break;case "closed":b="https://github.com/images/modules/dashboard/news/issues_closed.png",c="closed issue on "+d}break;case "GistEvent":b="https://github.com/images/modules/dashboard/news/gist.png";switch(a.payload.action){case "create":c="created "+
this._strongify(a.payload.name);break;case "update":c="updated "+this._strongify(a.payload.name);break;case "fork":c="forked "+this._strongify(a.payload.name)}break;case "WikiEvent":case "GollumEvent":b="https://github.com/images/modules/dashboard/news/wiki.png";switch(a.payload.action){case "created":c="created a wiki page on "+d;break;case "edited":c="edited a wiki page on "+d}break;case "CommitCommentEvent":b="https://github.com/images/modules/dashboard/news/comment.png";c="commented on "+d;break;
case "DeleteEvent":b="https://github.com/images/modules/dashboard/news/delete.png";switch(a.payload.ref_type){case "branch":c="deleted branch "+this._strongify(a.payload.ref)+" at "+d}break;case "PublicEvent":b="https://github.com/images/modules/dashboard/news/public.png";c="open sourced "+d;break;case "DownloadEvent":c=null}return c!=null?[e,b,f,c]:[]};e.prototype._parseGitHubTimeline=function(a,b){var d,c,e,g;c=[];e=0;for(g=a.length;e<g;e++)d=a[e],d=this._parseGitHubEvent(d),d.length&&c.push(d);
return b(c)};e.prototype.getTimelineForUser=function(a,b){jQuery.ajaxSetup({cache:!0});return jQuery.getJSON("https://github.com/"+a+".json?callback=?",__bind(function(a){return this._parseGitHubTimeline(a,b)},this))};e.prototype.getUserIdForUser=function(a,b){jQuery.ajaxSetup({cache:!0});return jQuery.getJSON("https://github.com/api/v2/json/user/show/"+a+"?callback=?",__bind(function(a){return b(a.user.id)},this))};return e}();
jQuery.fn.githubTimelineWidget=function(e){var a,b,d,c,f,g,i;a={username:"timeline",limit:5};c=document.getElementsByTagName("script");f=0;for(g=c.length;f<g;f++)if(b=c[f],(i=b.src)!=null&&i.match(/github-timeline-widget\.js/)){d=b.src.replace(/github-timeline-widget\.js.*$/,"");break}d!=null&&jQuery("<link/>").attr("rel","stylesheet").attr("type","text/css").attr("href",d+"github-timeline-widget.css").prependTo("head");return this.each(function(){var b,c,d,f;d=this;b=jQuery(this);d.opts=jQuery.extend({},
a,e);jQuery("<a>").attr("class","github-timeline-header").attr("href","https://github.com/"+d.opts.username).text(""+d.opts.username+" on GitHub").appendTo(b);f=jQuery("<ul>").attr("class","github-timeline-events").appendTo(b);c=new GitHubTimelineApi;c.getTimelineForUser(d.opts.username,function(a){var e,h,g,i,l,j,k,m;i=d.opts.limit;k=0;for(m=a.length;k<m;k++){h=a[k];if(i--===0)break;g=h[0];e=h[1];j=h[2];l=h[3];h=jQuery("<li>").attr("class","github-timeline-event").appendTo(f);g=jQuery("<a>").attr("href",
g);e&&jQuery("<img>").attr("src",e).appendTo(h).wrap(jQuery("<div>").attr("class","github-timeline-event-icon")).wrap(g);e=jQuery("<div>").attr("class","github-timeline-event-text").html(l).appendTo(h).wrapInner(g);j&&(j=c.formatAsTimeAgo(new Date(j)))&&jQuery("<div>").attr("class","github-timeline-event-time").text(j).appendTo(e)}return jQuery("<a>").attr("class","github-timeline-source-link").attr("href","https://github.com/alindeman/github-timeline-widget").text("GitHub Timeline Widget").appendTo(b)});
return c.getUserIdForUser(d.opts.username,function(a){return jQuery("<span>").attr("class","github-timeline-header-user-id").text("(user #"+a+")").appendTo(".github-timeline-header")})})};
